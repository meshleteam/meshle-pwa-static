(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{94309:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return n(97594)}])},8215:function(e,t,n){"use strict";n.d(t,{a:function(){return Loader}});var i=n(85893),a=n(88742),r=n(92590),s=n(87740),l=n(86597),c=n(17205),o=n(96476);let Loader=e=>{let{message:t}=e;return(0,i.jsx)(a.R,{backdrop:"blur",placement:"center",isDismissable:!1,defaultOpen:!0,shouldBlockScroll:!0,hideCloseButton:!0,classNames:{base:"bg-primary"},radius:"md",shadow:"sm",children:(0,i.jsxs)(r.A,{className:"text-center text-white gap-1",children:[(0,i.jsx)(s.k,{className:"flex flex-col",children:t}),(0,i.jsxs)(l.I,{children:[(0,i.jsx)(c.W,{size:"sm",isIndeterminate:!0,"aria-label":"Loading...",color:"primary",className:"max-w-md border-0"}),(0,i.jsx)(o.R,{})]})]})})}},25415:function(e,t,n){"use strict";n.d(t,{i:function(){return ProtectedRoute}});var i=n(85893),a=n(67294),r=n(11163),s=n(9473),l=n(84165),c=n(8215),o=n(92329),d=n(8501),u=n(67929),h=n(86086),p=n(63742),m=n(38442),x=n(86896),v=n(82010);let ProtectedRoute=e=>{let{children:t}=e,n=(0,r.useRouter)(),{authenticated:f,authenticationMethod:g}=(0,s.v9)(l.oH),w=(0,s.v9)(o.t4),[b,j]=a.useState(!1),{formatMessage:y}=(0,x.Z)(),N=(0,m.si)(["u","p"]),{theme:I}=(0,v.F)(),M=(0,s.I0)(),[C,k]=(0,u.Z)(async()=>{await M((0,l.CP)()).unwrap()},[M]);return(0,h.Z)("visibilitychange",()=>{"visible"===document.visibilityState&&k()}),(0,p.Z)(()=>k()),a.useEffect(()=>{j(n.isReady)},[n.isReady]),a.useEffect(()=>{if(b&&!C.loading){if(!f){N("login-form"===g?"login":"/expire");return}if(d.Z.falsy(w)&&"/pwa/select-network"!==n.pathname){N("/select-network");return}if("dh"!==I&&"/floor-plan"===n.pathname){N("/home");return}}},[f,g,w,b,N,n.pathname,C.loading,I]),(0,i.jsxs)("div",{children:[!b||C.loading&&(0,i.jsx)(c.a,{message:y({id:C.loading?"app.text.authenticating":"app.text.loading"})}),t]})}},65283:function(e,t,n){"use strict";var i=n(85893),a=n(67294),r=n(41664),s=n.n(r),l=n(11163),c=n(91086);t.Z=(0,a.forwardRef)((e,t)=>{let{href:n,omitParams:a,...r}=e,o=(0,l.useRouter)();return(0,i.jsx)(s(),{...r,ref:t,href:(0,c.WV)(o.asPath,n.toString(),a)})})},66794:function(e,t,n){"use strict";n.d(t,{Z:function(){return Footer}});var i=n(85893),a=n(67294),r=n(86896),s=n(11752),l=n.n(s),c=n(40329),o=n.n(c),Imprint=e=>{let{setModal:t}=e,{formatMessage:n}=(0,r.Z)(),hideModal=()=>{t(!1),document.body.style.overflow="auto";let e=document.getElementsByTagName("html")[0];e.style.overflow="auto",e.style.position="unset",e.style.height="unset"};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{onClick:()=>hideModal(),className:o().overlay}),(0,i.jsx)("div",{className:"".concat(o().colorPickerWrap),children:(0,i.jsx)("div",{className:o().colorPickerContainer,children:(0,i.jsxs)("div",{className:"".concat(o().colorPicker," ").concat(o().imprint),children:[(0,i.jsx)("h2",{children:n({id:"app.footer.imprint"})}),(0,i.jsxs)("div",{className:"".concat(o().imprintMain),children:[(0,i.jsx)("div",{children:n({id:"app.footer.line1"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line2"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line3"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line4"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line5"})}),(0,i.jsxs)("div",{className:"mt-[50px]",children:[(0,i.jsx)("div",{children:n({id:"app.footer.line6"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line7"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line8"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line9"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line10"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line11"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line12"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line13"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line14"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line15"})}),(0,i.jsx)("div",{children:n({id:"app.footer.line16"})})]})]}),(0,i.jsx)("button",{onClick:()=>{hideModal()},className:o().ctaBtn,children:n({id:"app.text.close"})})]})})})]})};function Footer(){let{publicRuntimeConfig:e}=l()(),[t,n]=(0,a.useState)(!1),{formatMessage:s}=(0,r.Z)();return(0,i.jsxs)("div",{className:"w-full grid justify-items-center",children:[(0,i.jsxs)("div",{className:"flex px-2 py-6 opacity-50 justify-between w-full max-w-[600px]",children:[(0,i.jsx)("button",{className:"underline text-left",onClick:()=>{n(!0),document.body.style.overflow="hidden";let e=document.getElementsByTagName("html")[0];e.style.overflow="hidden",e.style.position="relative",e.style.height="100%"},children:s({id:"app.footer.imprint"})}),(0,i.jsx)("div",{className:"text-center",children:s({id:"app.footer.caption"})}),(0,i.jsxs)("div",{className:"text-right",children:["v. ",null==e?void 0:e.version]})]}),t&&(0,i.jsx)(Imprint,{setModal:n})]})}},33467:function(e,t,n){"use strict";var i=n(85893),a=n(9473),r=n(84165),s=n(31787),l=n(21493),c=n(79479),o=n(84321),d=n(27371),u=n(19059),h=n(32616),p=n(45336),m=n(2653),x=n(86896),v=n(76714),f=n(65283),g=n(82010),w=n(11163),b=n(91086);t.Z=()=>{let e=(0,a.I0)(),t=(0,w.useRouter)(),{formatMessage:n}=(0,x.Z)(),j=(0,s.S)(),{theme:y}=(0,g.F)();return(0,i.jsx)("div",{className:"w-full max-w-[600px] self-center",children:(0,i.jsxs)(l.R,{classNames:{wrapper:"px-2"},className:"bg-transparent backdrop-saturate-100 backdrop-blur-none",children:[(0,i.jsx)(c.U,{justify:"start",children:(0,i.jsxs)(o.F,{className:"p-0",children:[(0,i.jsx)(d.S,{className:"appearance-none",children:(0,i.jsx)("div",{children:(0,i.jsx)(v.Z,{icon:"ic_burger",className:"stroke-[60px] fill-white round-svg",size:40})})}),(0,i.jsx)(u.a,{"aria-label":"Static Actions",className:"justify-self-end",children:(0,i.jsx)(h.W,{onPress:()=>{e((0,r.kS)())},children:n({id:"app.text.logout"})},"logout")})]})}),(0,i.jsx)(c.U,{justify:"center",children:(0,i.jsx)(p.H,{children:(null==j?void 0:j.logo)?(0,i.jsx)(m.J,{src:(0,b.Fc)("/".concat(null==j?void 0:j.logo)),width:j.logoWidth,height:j.logoHeight,alt:"logo",radius:"none"}):(0,i.jsx)(v.Z,{icon:"ic_meshle-full",size:55})})}),(0,i.jsx)(c.U,{justify:"end",children:"dh"===y&&(0,i.jsx)(f.Z,{href:"/floor-plan"===t.pathname?"/home":"/floor-plan",children:(0,i.jsx)(v.Z,{icon:"/floor-plan"===t.pathname?"ic_menu":"ic_floorplan",size:24})})})]})})}},31787:function(e,t,n){"use strict";n.d(t,{S:function(){return useVars}});var i=n(67294),a=n(90869);let useVars=()=>i.useContext(a.c)},97594:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return home}});var i=n(85893),a=n(67294),r=n(9473),s=n(33467),l=n(66794),c=n(92329),o=n(86896),d=n(14219),u=n(23091),h=n(18266),p=n(61574),m=n(76714);let CategoryList=e=>{let{category:t,setCategory:n,availableCategories:r}=e,{formatMessage:s}=(0,o.Z)(),l=a.useCallback(e=>{switch(e){case p.$.light:return"ic_bulb_off";case p.$.switch:return"ic_switch_double";case p.$.shutter:return"ic_shutter";case p.$.heating:return"ic_multi_sensor";default:return""}},[]),c=a.useCallback(e=>{switch(e){case p.$.light:return s({id:"app.device.lights.title"});case p.$.switch:return s({id:"app.device.switches.title"});case p.$.shutter:return s({id:"app.device.shutter.title"});case p.$.heating:return s({id:"app.device.heating.title"});default:return""}},[s]);return(0,i.jsx)(d.o,{orientation:"horizontal",className:"overflow-auto",hideScrollBar:!0,children:(0,i.jsx)(u.X,{"aria-label":"groups",variant:"bordered",className:"grid",classNames:{list:"grid grid-flow-col gap-5 auto-cols-min"},children:r.map(e=>(0,i.jsx)(h.R,{className:"border-none p-0 w-max outline-none",classNames:{base:"data-[focus-visible=true]:outline-none!"},onPress:()=>n(e),selectedIcon:(0,i.jsx)("div",{}),textValue:e+"",children:(0,i.jsxs)("div",{className:"grid gap-1",children:[(0,i.jsx)("div",{className:"max-w-fit	hover:bg-background/40 bg-background/10 p-4 ".concat(t===e?"bg-background/30":"","\n            rounded-md items-center"),children:(0,i.jsx)(m.Z,{size:40,icon:l(e),className:e===t?"text-white":"text-white/30"})}),(0,i.jsx)("h3",{className:"text-center text-md ".concat(t===e?"text-white":"text-white/30 "),children:c(e)})]})},e))})})};var x=n(27490),v=n(90047),f=n(90101),g=n(55903);let Pointer=e=>{let{className:t,color:n,left:a,top:r,style:s,prefixCls:l}=e,c={...s,position:"absolute",top:r,left:a},o="".concat(l,"-pointer ").concat(t||"");return(0,i.jsx)("div",{className:o,style:c,children:(0,i.jsx)("div",{className:"".concat(l,"-fill"),style:{width:10,height:10,transform:"translate(-5px, -5px)",boxShadow:"rgb(255 255 255) 0px 0px 0px 1.5px, rgb(0 0 0 / 30%) 0px 0px 1px 1px inset, rgb(0 0 0 / 40%) 0px 0px 1px 2px",borderRadius:"50%",backgroundColor:"#fff"},children:(0,i.jsx)("div",{style:{inset:0,borderRadius:"50%",position:"absolute",backgroundColor:n}})})})};var w=n(74691),b=n.n(w);let j=2*Math.PI,mod=(e,t)=>(e%t+t)%t,dist=(e,t)=>Math.sqrt(e*e+t*t);function getWheelDimensions(e){let{width:t=0}=e,n=t/2;return{width:t,radius:n,cx:n,cy:n}}function getHandleRange(e){let{width:t=0}=e;return t/2}function translateWheelAngle(e,t,n){let i=e.angle||0,a=e.direction;return n&&"clockwise"===a?t=i+t:"clockwise"===a?t=360-i+t:n&&"anticlockwise"===a?t=i+180-t:"anticlockwise"===a&&(t=i-t),mod(t,360)}let cctAngleToWhiteBalance=e=>{let t={...e};return e.h<=180?t.h=b()(127.5*((100-e.s)/100),0,127.5):t.h=b()(255*(e.s/100),127.5,255),t},hclToRgb=e=>{let t,n;return(e=34+e/100*66)<=66?(t=255,n=Math.min(Math.max(99.4708025861*Math.log(e)-161.1195681661,0),255)):(t=Math.min(Math.max(329.698727446*Math.pow(e-60,-.1332047592),0),255),n=Math.min(Math.max(288.1221695283*Math.pow(e-60,-.0755148492),0),255)),[Math.round(t),Math.round(n),Math.round(e>=66?255:e<=19?0:Math.min(Math.max(138.5177312231*Math.log(e-10)-305.0447927307,0),255))]};var y=n(91086);let N=a.forwardRef((e,t)=>{let{prefixCls:n="w-color-wheel",radius:r=0,pointer:s,className:l,style:c,width:o=200,height:d=200,direction:u="anticlockwise",angle:h=90,color:p,onChange:m,...x}=e,w="string"==typeof p&&(0,f.Ff)(p)?(0,v.HW)(p):p||{},b=cctAngleToWhiteBalance(w),N=hclToRgb(100*(0,y.et)(b.h,0,255,0,1)),I=p?(0,v.s)({r:N[0],g:N[1],b:N[2],a:w.a}):"",M=function(e,t){let{cx:n,cy:i}=getWheelDimensions(e),a=getHandleRange(e),r=(180+translateWheelAngle(e,t.h,!0))*(j/360),s=t.s/100*a,l="clockwise"===e.direction?-1:1;return{x:n+s*Math.cos(r)*l,y:i+s*Math.sin(r)*l}}({width:o},w),handleChange=(e,t)=>{let n=function(e,t,n){let{cx:i,cy:a}=getWheelDimensions(e),r=getHandleRange(e);t=i-t,n=a-n;let s=translateWheelAngle(e,Math.atan2(-n,-t)*(360/j)),l=Math.min(dist(t,n),r);return{h:Math.round(s),s:Math.round(100/r*l)}}({width:o},o-e.x,d-e.y),i={h:n.h,s:n.s,v:w.v,a:w.a};m&&m((0,v.$_)(i))};return(0,i.jsxs)(g.ZP,{className:[n,l||""].filter(Boolean).join(" "),...x,style:{position:"relative",width:o,height:d,...c},ref:t,onMove:handleChange,onDown:handleChange,children:[a.createElement(s||Pointer,{prefixCls:n,style:{zIndex:1,transform:"translate(".concat(M.x,"px, ").concat(M.y,"px)")},top:"0",left:"0",color:I}),(0,i.jsx)("div",{style:{position:"absolute",borderRadius:"50%",background:"anticlockwise"===u?"linear-gradient(hsl(213, 100%, 73%), hsl(25, 100%, 73%))":"linear-gradient(to bottom, #409cff 0%, #fffffb 50%, #ff6c00 100%)",transform:"rotateZ(".concat(h+90,"deg)"),inset:0}}),(0,i.jsx)("div",{style:{position:"absolute",borderRadius:"50%",background:"radial-gradient(circle closest-side, #fff, transparent)",inset:0}}),(0,i.jsx)("div",{style:{backgroundColor:"#000",borderRadius:"50%",position:"absolute",inset:0,opacity:"number"==typeof w.v?1-w.v/100:0}})]})});N.displayName="Hcl-Wheel";var I=n(88742),M=n(92590),C=n(87740),k=n(86597),T=n(80787),S=n(29505),_=n(65935),D=n(96476),O=n(27635),E=n(19755),Z=n.n(E);let hsvToRgb=(e,t,n)=>{let i,a,r;let s=Math.floor(6*e),l=6*e-s,c=n*(1-t),o=n*(1-l*t),d=n*(1-(1-l)*t);switch(s%6){case 0:i=n,a=d,r=c;break;case 1:i=o,a=n,r=c;break;case 2:i=c,a=n,r=d;break;case 3:i=c,a=o,r=n;break;case 4:i=d,a=c,r=n;break;default:i=n,a=c,r=o}return[Math.round(255*i),Math.round(255*a),Math.round(255*r)]};var components_ColorPicker=e=>{let{hclPicker:t,name:n,onHclChange:r,onHsvChange:s,usedColor:l,setBrightness:c,brightness:d,deviceType:u,...h}=e,[m,f]=(0,a.useState)(t?"hcl":"hsv"),[g,w]=(0,a.useState)((0,v.HW)(l)),[b,j]=(0,a.useState)((0,v.HW)(l)),[y,E]=(0,a.useState)(0),{formatMessage:P}=(0,o.Z)();(0,a.useEffect)(()=>{E(d)},[d]);let _onHsvChange=e=>{w({...e.hsva})},_onHclChange=e=>{j({...e.hsva})},changeMainClr=()=>{"hcl"===m?r(b):s(g)};return(0,a.useEffect)(()=>{let[e,t,n]="hcl"===m?hclToRgb(cctAngleToWhiteBalance(b).h):hsvToRgb(g.h/360,g.s/100,1),i=(0,v.s)({r:e,g:t,b:n,a:1});Z()(".track-1").css("backgroundColor",i)},[b,g.h,g.s,m]),(0,i.jsx)(I.R,{...h,backdrop:"blur",placement:"center",hideCloseButton:!0,classNames:{base:"bg-transparent shadow-none"},children:(0,i.jsx)(M.A,{children:e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C.k,{className:"flex flex-col gap-1 text-white text-center",children:n}),(0,i.jsxs)(k.I,{children:[(0,i.jsxs)(T.n,{classNames:{tabList:u!==p.Y.Multy?"hidden":""},onSelectionChange:e=>f(e),defaultSelectedKey:m,"aria-label":"Options",fullWidth:!0,variant:"bordered",color:"default",children:[(0,i.jsx)(S.r,{title:"HSV",children:(0,i.jsx)("div",{onMouseUp:()=>changeMainClr(),onTouchEnd:()=>changeMainClr(),children:(0,i.jsx)(x.Z,{color:g,onChange:_onHsvChange,width:300,height:300})})},"hsv"),(0,i.jsx)(S.r,{title:"HCL",children:(0,i.jsx)("div",{onMouseUp:()=>changeMainClr(),onTouchEnd:()=>changeMainClr(),children:(0,i.jsx)(N,{color:b,onChange:_onHclChange,width:300,height:300})})},"hcl")]}),(0,i.jsx)(_.L,{step:1,maxValue:100,minValue:0,value:y,onChange:e=>E(e),onChangeEnd:e=>c(e),hideThumb:!0,size:"lg",classNames:{trackWrapper:"rounded-md h-[50px] border w-full overflow-hidden",track:"rounded-none h-full bg-transparent",filler:"track-1"}})]}),(0,i.jsx)(D.R,{className:"justify-center",children:(0,i.jsx)(O.A,{variant:"light",size:"lg",className:"text-white",onPress:e,children:P({id:"app.text.close"})})})]})})})},P=n(45338);let OverlaySlider=e=>{let{title:t,value:n,color:r,coords:s,...l}=e,c=a.useRef(null);return a.useEffect(()=>{c.current&&(c.current.style.paddingTop=s?"".concat(s[1]-97.5,"px"):"50%")},[s]),a.useEffect(()=>{Z()(".overlay-slider-fill").css("backgroundColor",r),Z()(".overlay-slider-fill").css("width","".concat(n,"%"))},[n,r]),(0,i.jsx)(I.R,{...l,backdrop:"blur",placement:"center",hideCloseButton:!0,classNames:{base:"bg-black/20 shadow-none"},size:"full",children:(0,i.jsxs)(M.A,{children:[(0,i.jsx)(C.k,{className:"flex flex-col gap-1 text-white text-center",children:t}),(0,i.jsx)(k.I,{children:(0,i.jsx)("div",{ref:c,children:(0,i.jsx)("div",{className:"h-[65px] rounded-[10px] w-full",children:(0,i.jsx)("div",{className:"h-full bg-white overlay-slider-fill rounded-md"})})})})]})})};var R=n(41027),B=n(99601);let ColorfulItem=e=>{let t=(0,r.I0)(),[n,s]=a.useState("#ffffff"),[l,o]=a.useState(0),[d,u]=a.useState([0,0]),h=a.useRef(null),x=a.useRef(null),[f,g]=a.useState(!1),{isOpen:w,onOpen:b,onOpenChange:j}=(0,R.q)(),y=(0,R.q)(),N=a.useMemo(()=>(0,B.fp)(e.deviceType,e.multyMode),[e.deviceType,e.multyMode]);a.useEffect(()=>{f||o(e.isOn?e.brightness:0)},[e.brightness,e.isOn,f]),a.useEffect(()=>{if(!e.isGroup&&!N){let[t,n,i]=hsvToRgb(e.hue,e.saturation,1);s((0,v.s)({r:t,g:n,b:i,a:1}))}},[N,e.hue,e.isGroup,e.saturation]),a.useEffect(()=>{if(!e.isGroup&&N){let[t,n,i]=hclToRgb(100*e.whiteBalance);s((0,v.s)({r:t,g:n,b:i,a:1}))}},[N,e.isGroup,e.whiteBalance]),a.useEffect(()=>{if(!h.current)return;let e=h.current.querySelector(".rangeslider-fill");e.style.backgroundColor=n},[n]),a.useEffect(()=>{x.current&&(e.isOn?x.current.style.width=l+"%":x.current.style.width="0%")},[l,e.isOn]);let I=(0,P.QS)({trackMouse:!0,trackTouch:!0,delta:50,onTap:()=>{e.isGroup||e.deviceType===p.Y.Dimmer||b()},onSwipeStart:()=>g(!0),onSwiping:e=>{"Up"!==e.dir&&"Down"!==e.dir&&(e.event instanceof MouseEvent?e.event&&e.event.clientX&&o(Math.round(Math.min(Math.max(e.event.clientX/(.9*window.innerWidth)*100,0),100))):e.event&&e.event.targetTouches[0]&&e.event.targetTouches[0].clientX&&o(Math.round(Math.min(Math.max(e.event.targetTouches[0].clientX/(.9*window.innerWidth)*100,0),100))),e.first&&(y.onOpen(),u(e.initial)))},onSwiped:e=>{g(!1),y.onClose(),"Up"!==e.dir&&"Down"!==e.dir&&M("setBrightness",{brightness:l})}}),M=a.useCallback((n,i)=>{e.isGroup?[p.Y.Hsv,p.Y.Dimmer,p.Y.Hcl,p.Y.Multy].forEach(a=>{t((0,c.xl)({deviceId:e.tbDeviceId,obj:{...i,deviceId:e.deviceId,deviceType:a},func:n,broadcast:"manual"}))}):t((0,c.xl)({deviceId:e.tbDeviceId,obj:i,func:n,broadcast:"none"}))},[t,e.deviceId,e.isGroup,e.tbDeviceId]);return(0,i.jsxs)(i.Fragment,{children:[w&&(0,i.jsx)(components_ColorPicker,{isOpen:!0,onOpenChange:j,hclPicker:N,deviceType:e.deviceType,brightness:l,setBrightness:e=>M("setBrightness",{brightness:e}),onHclChange:e=>{M("setColor",{whiteBalance:cctAngleToWhiteBalance(e).h,brightness:l||50})},onHsvChange:e=>{M("setColor",{hue:e.h,saturation:e.s,brightness:l||50})},usedColor:n,name:e.deviceName}),(0,i.jsxs)("div",{className:"grid grid-flow-col-dense grid-cols-deviceItem gap-[3px]",children:[(0,i.jsxs)("div",{...I,ref:e=>{I.ref(e),h.current=e},className:"h-[65px] input-slider relative",children:[(0,i.jsx)("p",{className:"pointer-events-none absolute top-1/2 -translate-y-1/2 left-[3%] text-[18px] text-shadow",children:e.deviceName}),(0,i.jsx)("div",{className:"h-[65px] z-10 w-full bg-white/20 rounded-l-[10px] overflow-hidden",children:(0,i.jsx)("div",{ref:x,className:"rangeslider-fill h-full transition-[width] duration-100 ease-linear"})})]}),(0,i.jsx)("div",{onClick:()=>M("setPowerMesh",{isOn:!e.isOn}),className:"flex w-[65px] h-[65px] shrink-0 justify-center items-center cursor-pointer rounded-r-[10px] bg-white/20 text-white",children:(0,i.jsx)(m.Z,{icon:"ic_onoff",size:35})})]}),(0,i.jsx)(OverlaySlider,{isOpen:y.isOpen,onOpenChange:y.onOpenChange,color:n,title:e.deviceName,value:l,coords:d})]})},ShutterItem=e=>{let t=(0,r.I0)(),[n,s]=a.useState(0),[l,o]=a.useState([0,0]),d=a.useRef(null),[u,h]=a.useState(!1),x=(0,R.q)();a.useEffect(()=>{u||s(e.percentage)},[e.percentage,u]),a.useEffect(()=>{d.current&&(d.current.style.width=n+"%")},[n]);let v=(0,P.QS)({trackMouse:!0,trackTouch:!0,delta:50,onSwipeStart:()=>h(!0),onSwiping:e=>{"Up"!==e.dir&&"Down"!==e.dir&&(e.event instanceof MouseEvent?e.event&&e.event.clientX&&s(Math.round(Math.min(Math.max(e.event.clientX/(.9*window.innerWidth)*100,0),100))):e.event&&e.event.targetTouches[0]&&e.event.targetTouches[0].clientX&&s(Math.round(Math.min(Math.max(e.event.targetTouches[0].clientX/(.9*window.innerWidth)*100,0),100))),e.first&&(x.onOpen(),o(e.initial)))},onSwiped:e=>{h(!1),x.onClose(),"Up"!==e.dir&&"Down"!==e.dir&&f("moveShutter",{direction:3,openPercentage:n,changed:0,duration:0})}}),f=a.useCallback((n,i)=>{t((0,c.xl)({deviceId:e.tbDeviceId,obj:{...i,...e.isGroup?{deviceId:e.deviceId,deviceType:p.Y.Shutter}:{}},func:n,broadcast:e.isGroup?"manual":"none"}))},[t,e.deviceId,e.isGroup,e.tbDeviceId]),g=a.useCallback(t=>{let n;"up"===t?(n=0,e.channel2&&(n=1)):"down"===t&&(n=2,e.channel1&&(n=1)),f("moveShutter",{direction:n,changed:0,duration:0,usePosition:!0})},[e.channel1,e.channel2,f]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"grid grid-flow-col-dense grid-cols-deviceItem gap-[3px]",...v,children:[(0,i.jsxs)("div",{className:"h-[65px] relative",children:[(0,i.jsx)("p",{className:"pointer-events-none absolute top-1/2 -translate-y-1/2 left-[3%] text-[18px] text-shadow",children:e.deviceName}),(0,i.jsx)("div",{className:"h-[65px] z-10 w-full bg-white/20 rounded-l-[10px] overflow-hidden",children:(0,i.jsx)("div",{ref:d,className:"h-full transition-[width] bg-white duration-100 ease-linear"})})]}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{onClick:()=>g("up"),className:"flex w-[65px] h-[65px] shrink-0 justify-center items-center cursor-pointer ".concat(e.channel2?"bg-white text-black":"bg-white/20 text-white"),children:(0,i.jsx)(m.Z,{icon:"ic_arrow_up",size:35})}),(0,i.jsx)("div",{onClick:()=>g("down"),className:"flex w-[65px] h-[65px] shrink-0 justify-center items-center cursor-pointer rounded-r-[10px] ".concat(e.channel1?"bg-white text-black":"bg-white/20 text-white"),children:(0,i.jsx)(m.Z,{icon:"ic_arrow-down",size:35})})]})]}),(0,i.jsx)(OverlaySlider,{color:"#fff",coords:l,isOpen:x.isOpen,onOpenChange:x.onOpenChange,title:e.deviceName,value:n})]})},SwitchItem=e=>{let t=(0,r.I0)(),n=a.useCallback((n,i)=>{t((0,c.xl)({deviceId:e.tbDeviceId,obj:{...i,...e.isGroup?{deviceId:e.deviceId,deviceType:p.Y.Switch}:{}},func:n,broadcast:e.isGroup?"manual":"none"}))},[t,e.deviceId,e.isGroup,e.tbDeviceId]);return(0,i.jsxs)("div",{className:"grid grid-flow-col-dense grid-cols-deviceItem gap-[3px]",style:{marginBottom:e.isGroup?"10px":0},children:[(0,i.jsxs)("div",{className:"h-[65px] input-slider relative",children:[(0,i.jsx)("p",{className:"pointer-events-none absolute top-1/2 -translate-y-1/2 left-[3%] text-[18px] text-shadow",children:e.deviceName}),(0,i.jsx)("div",{className:"h-[65px] z-10 w-full bg-white/20 rounded-l-[10px] overflow-hidden",children:(0,i.jsx)("div",{className:"h-full transition-[width] bg-white duration-100 ease-linear ".concat(e.isOn?"w-full":"w-0")})})]}),(0,i.jsx)("div",{onClick:()=>{e.isGroup?n("setPowerMesh",{isOn:!e.isOn}):void 0!==e.channelIndex&&n("setPower",{channelIndex:e.channelIndex,channelStatus:!e.isOn})},className:"flex w-[65px] h-[65px] shrink-0 justify-center items-center cursor-pointer rounded-r-[10px] bg-white/20 text-white",children:(0,i.jsx)(m.Z,{icon:"ic_onoff",size:35})})]})};var G=n(94622),W=n(8501),H=n(44884);let HeaterItem=e=>{let[t,n]=a.useState(0);(0,a.useEffect)(()=>{n((0,y.et)(e.targetTemperature,e.minTemperature,e.maxTemperature,0,100))},[e.maxTemperature,e.minTemperature,e.targetTemperature]);let r=a.useRef(null),s=a.useRef(null);a.useEffect(()=>{r.current&&(r.current.style.width=t+"%")},[t]);let l=a.useMemo(()=>Math.round(2*parseFloat((0,y.et)(t,0,100,e.minTemperature,e.maxTemperature).toFixed(1)))/2,[e.maxTemperature,e.minTemperature,t]),c=(0,P.QS)({trackMouse:!0,trackTouch:!0,delta:50,preventScrollOnSwipe:!0,onSwiping:e=>{"Up"!==e.dir&&"Down"!==e.dir&&(e.event instanceof MouseEvent?e.event&&e.event.clientX&&n(Math.round(Math.min(Math.max(e.event.clientX/(.9*window.innerWidth)*100,0),100))):e.event&&e.event.targetTouches[0]&&e.event.targetTouches[0].clientX&&n(Math.round(Math.min(Math.max(e.event.targetTouches[0].clientX/(.9*window.innerWidth)*100,0),100))))},onSwiped:t=>{"Up"!==t.dir&&"Down"!==t.dir&&e.onTempChange(l)}});return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"grid grid-flow-col-dense grid-cols-deviceItem gap-[3px]",children:(0,i.jsxs)("div",{...c,ref:e=>{c.ref(e),s.current=e},className:"h-[65px] input-slider relative",children:[(0,i.jsx)("p",{className:"select-none pointer-events-none absolute top-1/2 -translate-y-1/2 left-[3%] text-[18px] text-shadow",children:e.deviceName}),(0,i.jsx)("div",{className:"h-[65px] z-10 w-full bg-white/20 rounded-[10px] overflow-hidden",children:(0,i.jsx)("div",{ref:r,className:"bg-white h-full transition-[width] duration-100 ease-linear"})}),(0,i.jsxs)("p",{className:"z-10 pointer-events-none absolute top-1/2 -translate-y-1/2 right-[3%] text-[18px] text-shadow",children:[e.currentTemperature.toFixed(1),"\xb0C / ",l.toFixed(1),"\xb0C"]})]})})})};var z=n(48008),A=n(88179);let Y=a.memo(function(e){let{tbDeviceId:t,deviceType:n,deviceId:a,name:r,extras:s}=e;return(0,i.jsx)(ColorfulItem,{active:s.active||!1,brightness:(0,y.et)(s.brightness||0,0,1,0,100),deviceId:a,deviceName:r,multyMode:s.multyMode,deviceType:n,isGroup:(0,B.ty)(a),isOn:s.isOn||!1,tbDeviceId:t,hue:s.hue||0,saturation:s.saturation||0,whiteBalance:s.whiteBalance||0},"colorful-device-"+t)}),F=a.memo(function(e){let{name:t,extras:n,tbDeviceId:a,deviceId:s,deviceType:l}=e,o=(0,r.I0)();return(0,i.jsx)(HeaterItem,{active:n.active||!1,minTemperature:5,maxTemperature:35,targetTemperature:n.targetTemperature||0,currentTemperature:n.currentTemperature||0,deviceName:t,onTempChange:e=>o((0,c.xl)({deviceId:a,broadcast:"none",func:"setTRVTargetTemp",obj:{deviceId:s,deviceType:l,targetTemperature:e}})),isGroup:!1,uid:a},"heater-device-"+a)}),$=a.memo(function(e){var t,n,a,s;let{uid:l,name:o,extras:d}=e,u=(0,r.I0)();return(0,i.jsx)(HeaterItem,{active:d.active||!1,minTemperature:(null!==(t=d.lower_temp)&&void 0!==t?t:40)*.1,maxTemperature:(null!==(n=d.upper_temp)&&void 0!==n?n:350)*.1,targetTemperature:(null!==(a=d.temp_set)&&void 0!==a?a:300)*.1,currentTemperature:(null!==(s=d.temp_current)&&void 0!==s?s:206)*.1,deviceName:o,onTempChange:e=>{var t;return null===(t=z.q.instance)||void 0===t?void 0:t.control.postDevicesDeviceIdCommands(l,{commands:[{code:"temp_set",value:10*e}]}).then(()=>u((0,c.xg)({data:{temp_set:[[Date.now(),(10*e).toString()]]},tbDeviceId:l}))).catch(console.error)},isGroup:!1,uid:l},"colorful-device-"+l)}),L=a.memo(function(e){var t,n,a;let{tbDeviceId:r,deviceType:s,extras:l,deviceId:c,name:o}=e;return(0,i.jsx)(ShutterItem,{active:null!==(t=l.active)&&void 0!==t&&t,isGroup:(0,B.ty)(c),channel1:null!==(n=l.channel0)&&void 0!==n&&n,channel2:null!==(a=l.channel1)&&void 0!==a&&a,deviceId:c,deviceName:o,deviceType:s,percentage:(0,y.et)(l.percentage||0,0,1,0,100),tbDeviceId:r},"shutter-device-"+r)}),U=a.memo(function(e){let{tbDeviceId:t,deviceType:n,deviceId:r,name:s,extras:l,additionalInfo:c}=e,o=a.useMemo(()=>({active:!1,isOn:!1,channel0:!1,...l}),[l]),d=a.useMemo(()=>!(0,B.ty)(r)&&W.Z.boolean(o.channel1),[r,o.channel1]),u=a.useMemo(()=>{var e;return d?"".concat(s," - ").concat(null!==(e=null==c?void 0:c[A.O8.Channel1Name])&&void 0!==e?e:"channel 1"):s},[c,d,s]),h=a.useMemo(()=>{var e;return d?"".concat(s," - ").concat(null!==(e=null==c?void 0:c[A.O8.Channel2Name])&&void 0!==e?e:"channel 2"):s},[c,d,s]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(SwitchItem,{active:o.active,deviceId:r,deviceName:u,deviceType:n,isGroup:(0,B.ty)(r),isOn:o.channel0,tbDeviceId:t,channelIndex:0},"switch-device-"+t+"-channel-0"),d&&(0,i.jsx)(SwitchItem,{active:o.active,deviceId:r,deviceName:h,deviceType:n,isGroup:(0,B.ty)(r),isOn:o.channel1,tbDeviceId:t,channelIndex:1},"switch-device-"+t+"-channel-1")]})});function GroupItem(e){let{category:t,devices:n,groupId:r}=e,s=a.useMemo(()=>{switch(t){case p.$.light:return p.Y.Dimmer;case p.$.shutter:return p.Y.Shutter;case p.$.switch:return p.Y.Switch;default:return p.Y.Any}},[t]),{formatMessage:l}=(0,o.Z)(),c=a.useMemo(()=>{switch(t){case p.$.light:return l({id:"app.text.allLights"});case p.$.shutter:return l({id:"app.text.allShutter"});case p.$.switch:return l({id:"app.text.allSwitches"});default:return""}},[t,l]),d=a.useMemo(()=>n.filter(e=>{let t=e.telemetry.active;return!W.Z.undefined(t)&&"true"===t[0].value})[0],[n]),u=a.useMemo(()=>{let e=(0,G.Q3)(s);return W.Z.undefined(d)?{}:e.reduce((e,t)=>{if(!(t in d.telemetry))return e;let i=(0,G.BN)(t,d.telemetry[t][0].value);switch(typeof i){case"boolean":i=n.some(e=>t in e.telemetry&&(0,G.BN)(t,e.telemetry[t][0].value));break;case"number":i=Math.max(...n.filter(e=>{var t;return(0,G.BN)("isOn",null!==(t=e.telemetry.isOn[0].value)&&void 0!==t?t:"false")}).map(e=>t in e.telemetry?(0,G.BN)(t,e.telemetry[t][0].value):0))}return e[t]=i,e},{})},[s,n,d]);return W.Z.undefined(d)?(0,i.jsx)("div",{className:"hidden"}):s===p.Y.Dimmer&&(0,i.jsx)(Y,{deviceId:128+r,deviceType:s,name:c,tbDeviceId:d.id.id,extras:u})||s===p.Y.Shutter&&(0,i.jsx)(L,{deviceId:128+r,name:c,deviceType:s,tbDeviceId:d.id.id,extras:u})||s===p.Y.Switch&&(0,i.jsx)(U,{deviceId:128+r,name:c,deviceType:s,tbDeviceId:d.id.id,extras:u})||(0,i.jsx)("div",{className:"hidden"})}function DeviceItem(e){let{device:t}=e,n=a.useMemo(()=>(0,G.yI)({name:t.name,type:t.type}),[t.name,t.type]),r=a.useMemo(()=>(0,G.dQ)(t.name),[t.name]),s=a.useMemo(()=>(0,G.Q3)(null!=n?n:p.Y.Any),[n]),l=a.useMemo(()=>s.reduce((e,n)=>{if(n in t.telemetry){let i=t.telemetry[n][0];e[n]=(0,G.BN)(n,i.value)}return e},{}),[s,t.telemetry]);return(0,B.PC)(n)&&(0,i.jsx)(Y,{deviceId:r,deviceType:n,name:t.label,tbDeviceId:t.id.id,extras:l})||n===p.Y.Shutter&&(0,i.jsx)(L,{deviceId:r,name:t.label,deviceType:n,tbDeviceId:t.id.id,extras:l})||n===p.Y.Switch&&(0,i.jsx)(U,{deviceId:r,name:t.label,additionalInfo:t.additionalInfo,deviceType:n,tbDeviceId:t.id.id,extras:l})||n===p.Y.Trv&&(0,i.jsx)(F,{deviceId:r,deviceType:n,name:t.label,extras:l,tbDeviceId:t.id.id})||n===H.U.Icon2RT&&(0,i.jsx)($,{name:t.name,extras:l,uid:t.id.id})||(0,i.jsx)("div",{className:"hidden"})}var X=n(44908),Q=n.n(X);let useAvailableCategories=e=>{let t=a.useMemo(()=>Q()(e.map(e=>(0,G.yI)({type:e.type,name:e.name})).filter(e=>e)),[e]);return a.useMemo(()=>Q()(t.map(e=>(0,G.VA)(e))).sort((e,t)=>e-t),[t])},useCategoryDevices=(e,t)=>a.useMemo(()=>e.filter(e=>{let n=(0,G.yI)({type:e.type,name:e.name});if(W.Z.undefined(n))return!1;let i=(0,G.VA)(n);return i===t}),[e,t]);var components_Devices=e=>{let{tbDeviceIds:t,groupId:n}=e,s=(0,r.v9)(e=>(0,c.F9)(e,t)),{formatMessage:l}=(0,o.Z)(),[d,u]=(0,a.useState)(p.$.none),h=useAvailableCategories(s),m=useCategoryDevices(s,d);return a.useEffect(()=>{h.length?h.includes(d)||u(h[0]):u(p.$.none)},[d,h]),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"mt-4 mb-3 mx-1",children:(0,i.jsx)(CategoryList,{availableCategories:h,category:d,setCategory:u})}),(0,i.jsx)("div",{className:"my-3 mb-5",children:(0,i.jsx)(GroupItem,{category:d,devices:m,groupId:n},"all-devices-".concat(d))}),(0,i.jsxs)("div",{className:"gap-[3px] grid",children:[d===p.$.heating&&(0,i.jsxs)("div",{className:"w-full p-[3px] flex text-[18px] text-white/30",children:[(0,i.jsx)("span",{className:"pointer-events-none",children:l({id:"app.text.temperature"})}),(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsxs)("span",{className:"pointer-events-none",children:[l({id:"app.text.currentTemperature"})," / ",l({id:"app.text.targetTemperature"})]})]}),m.map(e=>(0,i.jsx)(DeviceItem,{device:e},e.id.id))]})]})},V=n(84165),q=n(25415),J=n(14656),K=n(37676),ee=n(67929),et=n(8215),home=()=>{let{formatMessage:e}=(0,o.Z)(),t=(0,r.I0)(),{authenticated:n,token:d}=(0,r.v9)(V.oH),[u,h]=a.useState("devices"),p=(0,r.v9)(c.qK),m=(0,r.v9)(c.jA),[x,v]=(0,ee.Z)(async()=>{if(n)return await t((0,c.LO)())},[n,t]),[f,g]=(0,ee.Z)(async()=>{if(n)return await t((0,c.bt)()).unwrap().then(e=>e.reduce((e,n)=>e.then(()=>t((0,c.Fj)({tbGroupId:n.tbGroupId})).unwrap().catch(console.error)),Promise.resolve()))},[n]),w=a.useMemo(()=>p.map(e=>e.id.id),[p]),b=a.useMemo(()=>{let t={groupId:0,tbGroupId:"all-devices-group-uid",devices:w,name:e({id:"app.text.allDevices"})};return[t].concat(m)},[w,e,m]);(0,a.useEffect)(()=>{v().then(()=>g())},[v,g]);let j=a.useRef(new Map),{readyState:y,sendJsonMessage:N,lastJsonMessage:I}=(0,K.ZP)("wss://".concat("https://dash3.meshle.com".replace(/^https?:\/\//,""),"/api/ws/plugins/telemetry?token=")+d),M=a.useMemo(()=>({[K.kQ.CONNECTING]:"Connecting",[K.kQ.OPEN]:"Open",[K.kQ.CLOSING]:"Closing",[K.kQ.CLOSED]:"Closed",[K.kQ.UNINSTANTIATED]:"UnInstantiated"})[y],[y]),C=a.useMemo(()=>p.map(e=>({tbDeviceId:e.id.id,deviceType:(0,G.Cy)(e.name)})).filter(e=>!W.Z.undefined(e.deviceType)),[p]),k=a.useCallback(e=>{let{subscriptionId:n}=e,i=j.current.get(n);void 0!==i&&t((0,c.xg)({tbDeviceId:i,data:e.data}))},[t]);a.useEffect(()=>{W.Z.nullOrUndefined(I)||k(I)},[k,I]);let _=a.useCallback(()=>{if("Open"!==M)return;let e={tsSubCmds:[],historyCmds:[],attrSubCmds:[]};C.forEach(t=>{let n=(0,G.Q3)(t.deviceType);if(n.length){let i=j.current.size+1;j.current.set(i,t.tbDeviceId),e.tsSubCmds.push({entityType:"DEVICE",entityId:t.tbDeviceId,scope:"LATEST_TELEMETRY",cmdId:i,keys:n.reduce((e,t)=>e+","+t,"").slice(1)})}}),N(e)},[JSON.stringify(C),M,N]);a.useEffect(()=>{_()},[_]);let D=a.useCallback(e=>{W.Z.string(e)&&h(e)},[]);return(0,i.jsx)(q.i,{children:(0,i.jsxs)("div",{className:"flex flex-col w-full min-h-screen text-white bg-gradient-radial overflow-y-scroll",children:[(0,i.jsx)(s.Z,{}),(0,i.jsxs)("div",{className:"w-full flex-1",children:[x.loading&&(0,i.jsx)(et.a,{message:e({id:"app.text.fetchingDevices"})}),(0,i.jsx)("div",{className:"w-full mx-auto px-0.5 justify-self-center max-w-[600px] overflow-hidden",children:(0,i.jsxs)(T.n,{"aria-label":"Options",variant:"light",selectedKey:u,onSelectionChange:D,size:"md",disabledKeys:["loading-tab"],classNames:{tabList:"shadow-none",cursor:"bg-transparent shadow-none",tabContent:"text-lg overflow-hidden text-white/20 max-w-[120px] text-ellipsis group-data-[selected=true]:text-white ",tab:"data-[focus-visible=true]:outline-none!",base:"w-full",panel:"py-0"},children:[b.map(e=>(0,i.jsx)(S.r,{title:e.name,children:(0,i.jsx)(components_Devices,{tbDeviceIds:e.devices,groupId:e.groupId})},e.tbGroupId)),f.loading&&(0,i.jsx)(S.r,{children:(0,i.jsx)(J.Z,{size:"sm","aria-label":"Loading...",className:"scale-75"})},"loading-tab")]})})]}),(0,i.jsx)(l.Z,{})]})})}},40329:function(e){e.exports={colorPickerWrap:"ColorPicker_colorPickerWrap__YuPrc",colorPickerContainer:"ColorPicker_colorPickerContainer__Ue5pw",colorPicker:"ColorPicker_colorPicker__mG6VL",overlay:"ColorPicker_overlay__iyOqZ",colorBox:"ColorPicker_colorBox__iqn5T",ctaBtn:"ColorPicker_ctaBtn__RDJ49",imprintMain:"ColorPicker_imprintMain___afsG",imprint:"ColorPicker_imprint__6gpyJ"}}},function(e){e.O(0,[571,50,826,521,125,609,714,774,888,179],function(){return e(e.s=94309)}),_N_E=e.O()}]);